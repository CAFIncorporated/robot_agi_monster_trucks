//----------------------
// <auto-generated>
//     Generated from openapi.json. Run `dotnet build` or `nswag run nswag.json` to regenerate.
// </auto-generated>
//----------------------

using System.Net;
using System.Net.Http.Json;
using System.Text.Json.Serialization;

namespace CoordinateService.Client;

[JsonConverter(typeof(JsonStringEnumConverter))]
public enum Direction { N, S, E, W }

public class CreateCoordinateSystemRequest { public string? Name { get; set; } public int Width { get; set; } public int Height { get; set; } }
public class CreateCoordinateSystemResponse { public Guid Id { get; set; } }
public class CoordinateSystemDetail { public Guid Id { get; set; } public string? Name { get; set; } public int Width { get; set; } public int Height { get; set; } public DateTime CreatedAt { get; set; } public PointDetail? Point { get; set; } }
public class PointDetail { public Guid Id { get; set; } public int X { get; set; } public int Y { get; set; } public Direction Direction { get; set; } public DateTime CreatedAt { get; set; } }
public class CreatePointRequest { public int X { get; set; } public int Y { get; set; } public Direction Direction { get; set; } }
public class CreatePointResponse { public Guid Id { get; set; } public Guid SystemId { get; set; } public int X { get; set; } public int Y { get; set; } public Direction Direction { get; set; } }
public class MovePointRequest { public IList<string>? Commands { get; set; } }
public class MovePointResponse { public Guid Id { get; set; } public int X { get; set; } public int Y { get; set; } public Direction Direction { get; set; } public Guid SystemId { get; set; } }
public class ErrorResponse { public string? Error { get; set; } public string? Detail { get; set; } }

public class SwaggerException : Exception
{
    public HttpStatusCode StatusCode { get; }
    public HttpResponseMessage Response { get; }
    public SwaggerException(string message, HttpStatusCode statusCode, HttpResponseMessage response, Exception? inner = null)
        : base(message, inner) { StatusCode = statusCode; Response = response; }
}

public partial class CoordinateServiceClient
{
    private readonly HttpClient _httpClient;

    public CoordinateServiceClient(HttpClient httpClient) => _httpClient = httpClient;

    public async Task<CreateCoordinateSystemResponse> CreateCoordinateSystemAsync(CreateCoordinateSystemRequest body, CancellationToken ct = default)
    {
        var resp = await _httpClient.PostAsJsonAsync("/api/v1/coordinate-systems", body, ct);
        if (!resp.IsSuccessStatusCode) throw new SwaggerException(await resp.Content.ReadAsStringAsync(ct), resp.StatusCode, resp);
        return (await resp.Content.ReadFromJsonAsync<CreateCoordinateSystemResponse>(ct))!;
    }

    public async Task<CoordinateSystemDetail> GetCoordinateSystemAsync(Guid id, CancellationToken ct = default)
    {
        var resp = await _httpClient.GetAsync($"/api/v1/coordinate-systems/{id}", ct);
        if (resp.StatusCode == HttpStatusCode.NotFound) throw new SwaggerException("Not Found", resp.StatusCode, resp);
        resp.EnsureSuccessStatusCode();
        return (await resp.Content.ReadFromJsonAsync<CoordinateSystemDetail>(ct))!;
    }

    public async Task<HttpStatusCode> DeleteCoordinateSystemAsync(Guid id, CancellationToken ct = default)
    {
        var resp = await _httpClient.DeleteAsync($"/api/v1/coordinate-systems/{id}", ct);
        if (!resp.IsSuccessStatusCode) throw new SwaggerException(await resp.Content.ReadAsStringAsync(ct), resp.StatusCode, resp);
        return resp.StatusCode;
    }

    public async Task<CreatePointResponse> CreatePointAsync(Guid systemId, CreatePointRequest body, CancellationToken ct = default)
    {
        var resp = await _httpClient.PostAsJsonAsync($"/api/v1/coordinate-systems/{systemId}/points", body, ct);
        if (!resp.IsSuccessStatusCode) throw new SwaggerException(await resp.Content.ReadAsStringAsync(ct), resp.StatusCode, resp);
        return (await resp.Content.ReadFromJsonAsync<CreatePointResponse>(ct))!;
    }

    public async Task<PointDetail> GetPointAsync(Guid pointId, CancellationToken ct = default)
    {
        var resp = await _httpClient.GetAsync($"/api/v1/points/{pointId}", ct);
        if (resp.StatusCode == HttpStatusCode.NotFound) throw new SwaggerException("Not Found", resp.StatusCode, resp);
        resp.EnsureSuccessStatusCode();
        return (await resp.Content.ReadFromJsonAsync<PointDetail>(ct))!;
    }

    public async Task<HttpStatusCode> DeletePointAsync(Guid pointId, CancellationToken ct = default)
    {
        var resp = await _httpClient.DeleteAsync($"/api/v1/points/{pointId}", ct);
        if (!resp.IsSuccessStatusCode) throw new SwaggerException(await resp.Content.ReadAsStringAsync(ct), resp.StatusCode, resp);
        return resp.StatusCode;
    }

    public async Task<MovePointResponse> MovePointAsync(Guid pointId, MovePointRequest body, CancellationToken ct = default)
    {
        var resp = await _httpClient.PostAsJsonAsync($"/api/v1/points/{pointId}/move", body, ct);
        if (!resp.IsSuccessStatusCode) throw new SwaggerException(await resp.Content.ReadAsStringAsync(ct), resp.StatusCode, resp);
        return (await resp.Content.ReadFromJsonAsync<MovePointResponse>(ct))!;
    }
}
